{% extends 'base_new.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}

<section id="portfolio">
  <div class="container">
    {% if all_events %}
    <!-- <header class="section-header">
        <h3 class="section-title" style="color: #18d26e;">Events</h3>
      </header> -->

    <div class="row">
      <div class="col-lg-12">
        <ul id="portfolio-flters">
          <li data-filter="*" class="filter-active">All</li>
          <li data-filter=".filter-app">Technical</li>
          <li data-filter=".filter-web">Non-Technical</li>
        </ul>
      </div>
    </div>
    <div class="row portfolio-container">
      {% for event in all_events %}
      {% if event.category == "technical" %}
      <div class="col-lg-3 col-md-2 portfolio-item filter-app wow fadeInUp">
        {% else %}
        <div class="col-lg-3 col-md-2 portfolio-item filter-web wow fadeInUp">
          {% endif %}
          <div class="portfolio-wrap">
            <figure class="figure" data-toggle="modal" data-target="#event_{{ event.id }}">
              <img src="{{ event.cover.url }}" class="img-fluid" alt="">
            </figure>

            <div class="portfolio-info">
              <h6><a href="#" data-toggle="modal" data-target="#event_{{ event.id }}">{{ event.title|upper }}</a></h6>
              <p>{{ event.category|upper }}</p>
            </div>
          </div>
        </div>
        <!-- #event_desc Model-->

        <!-- Modal -->
        <div class="modal fade" id="event_{{event.id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
          aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">{{event.title|upper}}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body bg-dark" style="color:whitesmoke;">
                <ul class="nav nav-pills justify-content-center">
                  <li class="nav-item">
                    <a class="nav-link active" data-toggle="tab" href="#description_{{event.id}}">Description</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#rules_{{event.id}}">Rules</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#organizers_{{event.id}}">Organizers</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#winners_{{event.id}}">Winners</a>
                  </li>
                </ul>

                <div class="tab-content">
                  <div id="description_{{event.id}}" class="container tab-pane active"><br>
                    <p>{{ event.description }}</p>
                  </div>
                  <div id="rules_{{event.id}}" class="container tab-pane fade"><br>
                    <p>{{ event.rules}}</p>
                    <!-- <p>testing</p> -->
                  </div>
                  <div id="organizers_{{event.id}}" class="container tab-pane fade"><br>
                    <p>{{ event.organizers }}</p>
                  </div>
                  <div id="winners_{{event.id}}" class="container tab-pane fade"><br>
                    <p>{{ event.winners }}</p>
                  </div>
                </div>
              </div>
              <div class="modal-footer">

                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                {% if user.is_staff %}
                  {% if event.title in reg_events_titles %}
                    <button type="button" class="btn btn-success" disabled="true">Registered!</button>
                  {% elif event.no_of_participants > 1 %}
                    <button type="button" data-dismiss="modal" class="btn btn-primary" data-toggle="modal"
                    data-target="#addteam_{{event.id}}">Team Register</button>

                  {% else %}
                    <a href="{% url 'eventRegister' event.id %}" class="btn btn-primary">Register</a>
                  {% endif %}
                {% endif %}
              </div>
            </div>
          </div>
        </div>
        <!-- #end event model -->

        <!-- Adding-Team Modal -->
        <div class="modal fade modal-auto" id="addteam_{{event.id}}" tabindex="-1" role="dialog" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title text-center" id="exampleModalCenterTitle">{{ event.title|upper }} Team
                  Registration </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>

              <div class="modal-body">
                <form method="POST">
                  {% csrf_token %}
                  {% with ''|center:event.no_of_participants as range %}
                  {% for i in range %}
                  <div class="form-group">
                    <label>Team Member-{{forloop.counter}}</label>
                    {% if forloop.counter == 1 %}
                    <input type="text" name="user_{{forloop.counter}}" class="form-control" value="{{user.username}}"
                      disabled>
                    {% else %}
                    <input type="text" name="user_{{forloop.counter}}" class="form-control"
                      placeholder="Enter ID No-{{forloop.counter}}">
                    {% endif %}
                  </div>

                  {% endfor %}
                  {% endwith %}

              </div>

              <div class="modal-footer">
                <a href="{% url 'eventRegisterMany' event.id event.no_of_participants %}"
                  class="btn btn-primary">Register</a>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
              </form>
            </div>
          </div>
        </div>
        <!--End Adding-Team Modal -->
        {% endfor %}


        {% endif %}


      </div>
    </div>

</section>
{% endblock content%}